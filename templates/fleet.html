{% extends "base.html" %}
{% block content %}

<div style="padding: 100px 5% 40px; background: var(--bg-body); min-height: 100vh;">

    <div style="background: var(--bg-card); padding: 25px; border-radius: 12px; box-shadow: var(--shadow); margin-bottom: 40px; border: 1px solid var(--border);">
        <h1 style="margin-top: 0; font-size: 1.5rem; margin-bottom: 20px; color: var(--text-main);">Find your perfect drive</h1>
        
        <form action="{{ url_for('fleet') }}" method="GET" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; align-items: end;">
            
            <div>
                <label style="font-size: 0.8rem; font-weight: 700; color: var(--text-light); display: block; margin-bottom: 5px;">LOCATION</label>
                <select name="location" style="width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: 8px; background: var(--input-bg); color: var(--text-main);">
                    <option value="All">All Cities</option>
                    {% for loc in locations %}
                        <option value="{{ loc }}" {% if current_filters.get('location') == loc %}selected{% endif %}>{{ loc }}</option>
                    {% endfor %}
                </select>
            </div>

            <div>
                <label style="font-size: 0.8rem; font-weight: 700; color: var(--text-light); display: block; margin-bottom: 5px;">TYPE</label>
                <select name="category" style="width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: 8px; background: var(--input-bg); color: var(--text-main);">
                    <option value="All">All Types</option>
                    {% for cat in categories %}
                        <option value="{{ cat }}" {% if current_filters.get('category') == cat %}selected{% endif %}>{{ cat }}</option>
                    {% endfor %}
                </select>
            </div>

            <div>
                <label style="font-size: 0.8rem; font-weight: 700; color: var(--text-light); display: block; margin-bottom: 5px;">FUEL</label>
                <select name="fuel_type" style="width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: 8px; background: var(--input-bg); color: var(--text-main);">
                    <option value="All">All Fuel</option>
                    {% for fuel in fuel_types %}
                        <option value="{{ fuel }}" {% if current_filters.get('fuel_type') == fuel %}selected{% endif %}>{{ fuel }}</option>
                    {% endfor %}
                </select>
            </div>

            <button type="submit" class="btn-login" style="height: 42px; border: none; font-weight: bold; cursor: pointer;">
                Apply Filters
            </button>
        </form>
    </div>

    {% if cars %}
        <div class="car-grid" style="padding: 0;">
            {% for car in cars %}
            <div class="car-card">
                <div class="car-header">
                    <img src="{{ car.image_url }}" class="car-img" alt="{{ car.name }}">
                    <div class="rating-badge"><i class="fas fa-star" style="color:#f59e0b;"></i> {{ car.average_rating }}</div>
                </div>
                <div class="car-body">
                    <h3 class="car-title">{{ car.name }}</h3>
                    <span class="car-subtitle">{{ car.category }} • {{ car.location }}</span>
                    
                    <div class="specs">
                        <div class="spec-chip"><i class="fas fa-cog"></i> {{ car.transmission }}</div>
                        <div class="spec-chip"><i class="fas fa-gas-pump"></i> {{ car.fuel_type }}</div>
                        <div class="spec-chip"><i class="fas fa-user"></i> {{ car.seats }}</div>
                    </div>

                    <div class="car-footer">
                        <div class="price">₹{{ car.price_per_hr }}<span>/hr</span></div>
                        <a href="{{ url_for('book_car_dates', car_id=car.id) }}" class="btn-book">
                            Book Now <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    {% else %}
        <div style="text-align: center; padding: 80px 20px; color: var(--text-light);">
            <div style="background: var(--input-bg); width: 80px; height: 80px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px;">
                <i class="fas fa-search" style="font-size: 2rem; color: var(--text-light);"></i>
            </div>
            <h2 style="color: var(--text-main);">No cars available</h2>
            <p>Try adjusting your location or dates.</p>
            <a href="{{ url_for('fleet') }}" style="color: var(--primary); font-weight: bold; text-decoration: none;">Clear all filters</a>
        </div>
    {% endif %}

</div>
{% endblock %}
