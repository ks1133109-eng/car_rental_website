<!DOCTYPE html>
<html>
<head>
  <title>Admin Dashboard | DriveX</title>
</head>
<body>
{% extends "base.html" %}
{% block content %}

<div style="display: flex;">
    
    <div style="width: 250px; background: #0b121f; min-height: 100vh; padding: 20px; color: white;">
        <h3 style="margin-bottom: 30px;">Admin Panel</h3>
        
        <a href="{{ url_for('admin_dashboard') }}" style="display:block; padding:10px; color:white; background:var(--primary); border-radius:5px; text-decoration:none; margin-bottom: 5px;">
            <i class="fas fa-chart-line" style="width: 20px;"></i> Dashboard
        </a>
        
        <a href="{{ url_for('manage_cars') }}" style="display:block; padding:10px; color:#aaa; text-decoration:none; margin-bottom: 5px;">
            <i class="fas fa-car" style="width: 20px;"></i> Manage Cars
        </a>

        <a href="{{ url_for('manage_coupons') }}" style="display:block; padding:10px; color:#aaa; text-decoration:none; margin-bottom: 5px;">
            <i class="fas fa-tags" style="width: 20px;"></i> Coupons
        </a>

        <a href="{{ url_for('manage_bookings') }}" style="display:block; padding:10px; color:#aaa; text-decoration:none; margin-bottom: 5px;">
            <i class="fas fa-calendar-alt" style="width: 20px;"></i> Bookings
        </a>

        <a href="{{ url_for('manage_users') }}" style="display:block; padding:10px; color:#aaa; text-decoration:none; margin-bottom: 5px;">
            <i class="fas fa-users" style="width: 20px;"></i> Users
        </a>

        <a href="{{ url_for('logout') }}" style="display:block; padding:10px; color:#ff6b6b; margin-top: 20px; text-decoration:none;">
            <i class="fas fa-sign-out-alt" style="width: 20px;"></i> Logout
        </a>
    </div>

    <div style="flex: 1; padding: 40px; background: #f8f9fa;">
        <h2 style="margin-bottom: 30px;">Dashboard Overview</h2>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 40px;">
            
            <div style="background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); border-left: 5px solid #007bff;">
                <h4 style="margin: 0; color: #666; font-size: 0.9rem; text-transform: uppercase;">Total Fleet</h4>
                <p style="font-size: 2rem; font-weight: bold; margin: 10px 0 0;">{{ stats.total_fleet }}</p>
            </div>

            <div style="background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); border-left: 5px solid #28a745;">
                <h4 style="margin: 0; color: #666; font-size: 0.9rem; text-transform: uppercase;">Active Bookings</h4>
                <p style="font-size: 2rem; font-weight: bold; margin: 10px 0 0;">{{ stats.active_bookings }}</p>
            </div>

            <div style="background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); border-left: 5px solid #ffc107;">
                <h4 style="margin: 0; color: #666; font-size: 0.9rem; text-transform: uppercase;">Total Revenue</h4>
                <p style="font-size: 2rem; font-weight: bold; margin: 10px 0 0;">â‚¹{{ stats.revenue }}</p>
            </div>

            <div style="background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); border-left: 5px solid #dc3545;">
                <h4 style="margin: 0; color: #666; font-size: 0.9rem; text-transform: uppercase;">Pending KYC</h4>
                <p style="font-size: 2rem; font-weight: bold; margin: 10px 0 0;">{{ stats.pending_kyc }}</p>
            </div>

        </div>

        <h3 style="margin-bottom: 20px;">Verification Requests</h3>
        
        {% if pending_users %}
        <div style="background: white; padding: 0; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); overflow: hidden;">
            <table style="width: 100%; border-collapse: collapse;">
                <tr style="background: #f8f9fa; text-align: left; border-bottom: 1px solid #eee;">
                    <th style="padding: 15px;">User</th>
                    <th>Email</th>
                    <th>Documents</th>
                    <th>Action</th>
                </tr>
                {% for user in pending_users %}
                <tr style="border-bottom: 1px solid #eee;">
                    <td style="padding: 15px;">{{ user.name }}</td>
                    <td>{{ user.email }}</td>
                    <td>
                        <div style="display: flex; gap: 10px;">
                            <button onclick="openImage('{{ user.gov_id_image }}')" style="border: 1px solid #007bff; color: #007bff; background: white; padding: 4px 10px; border-radius: 4px; cursor: pointer;">
                                <i class="far fa-id-card"></i> ID
                            </button>
                            <button onclick="openImage('{{ user.user_selfie }}')" style="border: 1px solid #6610f2; color: #6610f2; background: white; padding: 4px 10px; border-radius: 4px; cursor: pointer;">
                                <i class="far fa-user"></i> Selfie
                            </button>
                        </div>
                    </td>
                    <td>
                        <a href="{{ url_for('approve_kyc', user_id=user.id) }}" style="background: #28a745; color: white; padding: 6px 12px; text-decoration: none; border-radius: 4px; font-size: 0.85rem; margin-right: 5px;">Approve</a>
                        <a href="{{ url_for('reject_kyc', user_id=user.id) }}" style="background: #dc3545; color: white; padding: 6px 12px; text-decoration: none; border-radius: 4px; font-size: 0.85rem;">Reject</a>
                    </td>
                </tr>
                {% endfor %}
            </table>
        </div>
        {% else %}
        <div style="background: white; padding: 40px; text-align: center; border-radius: 12px; color: #999; border: 2px dashed #eee;">
            <i class="fas fa-check-circle" style="font-size: 2rem; margin-bottom: 10px; opacity: 0.5;"></i>
            <p style="margin: 0;">All clear! No pending verification requests.</p>
        </div>
        {% endif %}

    </div>
</div>

<script>
    function openImage(base64Data) {
        var image = new Image();
        image.src = base64Data;
        var w = window.open("");
        w.document.write(image.outerHTML);
    }
</script>
{% endblock %}
</body>
</html>
