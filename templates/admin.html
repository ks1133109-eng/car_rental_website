<!DOCTYPE html>
<html>
<head>
  <title>Admin Dashboard | DriveX</title>
</head>
<body>
{% extends "base.html" %}
{% block content %}

<div style="display: flex;">
    
    <div style="width: 250px; background: #0b121f; min-height: 100vh; padding: 20px; color: white;">
        <h3 style="margin-bottom: 30px;">Admin Panel</h3>
        
        <a href="{{ url_for('admin_dashboard') }}" style="display:block; padding:10px; color:white; background:var(--primary); border-radius:5px; text-decoration:none;">
            Dashboard
        </a>
        
        <a href="{{ url_for('manage_cars') }}" style="display:block; padding:10px; color:#aaa; text-decoration:none;">
            Manage Cars
        </a>

        <a href="{{ url_for('manage_coupons') }}" style="display:block; padding:10px; color:#aaa; text-decoration:none;">
            Coupons
        </a>

        <a href="{{ url_for('manage_bookings') }}" style="display:block; padding:10px; color:#aaa; text-decoration:none;">
            Bookings
        </a>

        <a href="{{ url_for('manage_users') }}" style="display:block; padding:10px; color:#aaa; text-decoration:none;">
            Users
        </a>

        <a href="{{ url_for('logout') }}" style="display:block; padding:10px; color:#ff6b6b; margin-top: 20px;">
            Logout
        </a>
    </div>

    <div style="flex: 1; padding: 40px; background: #f8f9fa;">
        <h2 style="margin-bottom: 30px;">Dashboard Overview</h2>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 40px;">
            
            <div style="background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); border-left: 5px solid #007bff;">
                <h4 style="margin: 0; color: #666;">Total Fleet</h4>
                <p style="font-size: 2rem; font-weight: bold; margin: 10px 0 0;">{{ stats.total_fleet }}</p>
            </div>

            <div style="background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); border-left: 5px solid #28a745;">
                <h4 style="margin: 0; color: #666;">Active Bookings</h4>
                <p style="font-size: 2rem; font-weight: bold; margin: 10px 0 0;">{{ stats.active_bookings }}</p>
            </div>

            <div style="background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); border-left: 5px solid #ffc107;">
                <h4 style="margin: 0; color: #666;">Total Revenue</h4>
                <p style="font-size: 2rem; font-weight: bold; margin: 10px 0 0;">₹{{ stats.revenue }}</p>
            </div>

            <div style="background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); border-left: 5px solid #dc3545;">
                <h4 style="margin: 0; color: #666;">Pending KYC</h4>
                <p style="font-size: 2rem; font-weight: bold; margin: 10px 0 0;">{{ stats.pending_kyc }}</p>
            </div>

        </div>

        {% if pending_users %}
        <div style="background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05);">
            <h3 style="margin-top: 0; margin-bottom: 20px;">⚠️ Pending KYC Approvals</h3>
            
            <table style="width: 100%; border-collapse: collapse;">
                <tr style="background: #f8f9fa; text-align: left;">
                    <th style="padding: 15px;">User</th>
                    <th>Email</th>
                    <th>Documents</th>
                    <th>Action</th>
                </tr>
                {% for user in pending_users %}
                <tr style="border-bottom: 1px solid #eee;">
                    <td style="padding: 15px;">{{ user.name }}</td>
                    <td>{{ user.email }}</td>
                    <td>
                        <div style="display: flex; gap: 10px;">
                            {% if user.gov_id_image %}
                            <img src="{{ user.gov_id_image }}" style="width: 50px; height: 30px; object-fit: cover; border: 1px solid #ddd; border-radius: 4px; cursor: pointer;" onclick="window.open(this.src)">
                            {% else %}
                            <span style="color: red; font-size: 0.8rem;">No ID</span>
                            {% endif %}

                            {% if user.user_selfie %}
                            <img src="{{ user.user_selfie }}" style="width: 30px; height: 30px; object-fit: cover; border-radius: 50%; border: 1px solid #ddd; cursor: pointer;" onclick="window.open(this.src)">
                            {% else %}
                            <span style="color: red; font-size: 0.8rem;">No Selfie</span>
                            {% endif %}
                        </div>
                    </td>
                    <td>
                        <a href="{{ url_for('approve_kyc', user_id=user.id) }}" style="background: #28a745; color: white; padding: 6px 12px; text-decoration: none; border-radius: 4px; font-size: 0.85rem; margin-right: 5px;">Approve</a>
                        <a href="{{ url_for('reject_kyc', user_id=user.id) }}" style="background: #dc3545; color: white; padding: 6px 12px; text-decoration: none; border-radius: 4px; font-size: 0.85rem;">Reject</a>
                    </td>
                </tr>
                {% endfor %}
            </table>
        </div>
        {% endif %}

    </div>
</div>
{% endblock %}
</body>
</html>
