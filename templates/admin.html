<!DOCTYPE html>
<html>
<head>
  <title>Admin Dashboard | DriveX</title>
</head>
<body>
{% extends "base.html" %}
{% block content %}

<div class="admin-container">
    
    <div class="sidebar">
        <h3 style="margin-bottom: 20px;">Admin Panel</h3>
        <a href="{{ url_for('admin_dashboard') }}" class="sidebar-link active">Dashboard</a>
        <a href="{{ url_for('manage_cars') }}" class="sidebar-link">Manage Cars</a>
        <a href="{{ url_for('manage_coupons') }}" class="sidebar-link">Coupons</a>
        <a href="{{ url_for('manage_bookings') }}" class="sidebar-link">Bookings</a>
        <a href="{{ url_for('manage_users') }}" class="sidebar-link">Users</a>
        <a href="{{ url_for('logout') }}" class="sidebar-link" style="color:#ff6b6b; margin-top:20px;">Logout</a>
    </div>

    <div class="admin-content">
        <h2 style="margin-bottom: 20px; color: var(--text-main);">Dashboard Overview</h2>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 40px;">
            <div class="stat-card" style="border-left: 5px solid #007bff; background: var(--bg-card); color: var(--text-main);">
                <h4>Total Fleet</h4> <p style="font-size: 1.5rem; font-weight: bold;">{{ stats.total_fleet }}</p>
            </div>
            <div class="stat-card" style="border-left: 5px solid #28a745; background: var(--bg-card); color: var(--text-main);">
                <h4>Active Bookings</h4> <p style="font-size: 1.5rem; font-weight: bold;">{{ stats.active_bookings }}</p>
            </div>
            <div class="stat-card" style="border-left: 5px solid #ffc107; background: var(--bg-card); color: var(--text-main);">
                <h4>Revenue</h4> <p style="font-size: 1.5rem; font-weight: bold;">â‚¹{{ stats.revenue }}</p>
            </div>
            <div class="stat-card" style="border-left: 5px solid #dc3545; background: var(--bg-card); color: var(--text-main);">
                <h4>Pending KYC</h4> <p style="font-size: 1.5rem; font-weight: bold;">{{ stats.pending_kyc }}</p>
            </div>
        </div>

        <h3>Verification Requests</h3>
        <div style="overflow-x: auto; background: var(--bg-card); border-radius: 12px; margin-top: 15px; border: 1px solid var(--border);">
            <table style="width: 100%; border-collapse: collapse;">
                <tr style="background: var(--input-bg);">
                    <th style="padding:15px; color: var(--text-main);">User</th>
                    <th style="color: var(--text-main);">Email</th>
                    <th style="color: var(--text-main);">Docs</th>
                    <th style="color: var(--text-main);">Action</th>
                </tr>
                {% for user in pending_users %}
                <tr style="border-bottom: 1px solid var(--border);">
                    <td style="padding:15px; color: var(--text-main);">{{ user.name }}</td>
                    <td style="color: var(--text-main);">{{ user.email }}</td>
                    <td>
                        <button onclick="openImage('{{ user.gov_id_image }}')" style="padding:5px; margin-right:5px; cursor:pointer;">ID</button>
                        <button onclick="openImage('{{ user.user_selfie }}')" style="padding:5px; cursor:pointer;">Selfie</button>
                    </td>
                    <td>
                        <div style="display: flex; gap: 5px; flex-wrap: wrap;">
                            <a href="{{ url_for('approve_kyc', user_id=user.id) }}" style="background: #28a745; color: white; padding: 5px 10px; border-radius: 4px; text-decoration: none; font-size: 0.85rem;">Approve</a>
                            <a href="{{ url_for('reject_kyc', user_id=user.id) }}" style="background: #dc3545; color: white; padding: 5px 10px; border-radius: 4px; text-decoration: none; font-size: 0.85rem;">Reject</a>
                        </div>
                    </td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="4" style="text-align:center; padding:30px; color: var(--text-light);">No pending requests.</td>
                </tr>
                {% endfor %}
            </table>
        </div>
    </div>
</div>

<script>
function openImage(src){ var w=window.open(""); w.document.write('<img src="'+src+'" style="width:100%">'); }
</script>
{% endblock %}
</body>
</html>
